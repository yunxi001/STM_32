/*
 * @Author: _oufen
 * @Date: 2023-04-15 09:06:56
 * @LastEditTime: 2023-07-03 19:21:19
 * @Description: TIM7定时函数
 */

/* Includes -------------------------------------------------------------------------------------------------------------*/

#include "timer6.h"
#include "myconfig.h"

/* Define -----------------------------------------------------------------------------------------------------------------*/

/* Functions -----------------------------------------------------------------------------------------------------------------*/
/**
 * @brief 	TIM7初始化 用作定时器10ms
 * @param 	无
 * @retval  无
 */
/* //////////////////////////////////////////////////////////////////////


无外接IO口，所以只能当普通定时器使用！！！！！！

*/
/////////////////////////////////////////////////////////////////////


#include "stm32f10x.h"                  // Device header
 
void Timer6_Init(void)
{
	TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;
NVIC_InitTypeDef NVIC_InitStructure;
RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3, ENABLE); //①时钟 TIM3 使能
//定时器 TIM3 初始化
TIM_TimeBaseStructure.TIM_Period = arr; //设置自动重装载寄存器周期的值 
TIM_TimeBaseStructure.TIM_Prescaler =psc; //设置时钟频率除数的预分频值
TIM_TimeBaseStructure.TIM_ClockDivision = TIM_CKD_DIV1; //设置时钟分割
TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up; //TIM 向上计数
TIM_TimeBaseInit(TIM3, &TIM_TimeBaseStructure); //②初始化 TIM3
TIM_ITConfig(TIM3,TIM_IT_Update,ENABLE ); //③允许更新中断
//中断优先级 NVIC 设置
NVIC_InitStructure.NVIC_IRQChannel = TIM3_IRQn; //TIM3 中断
NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0; //先占优先级 0 级
NVIC_InitStructure.NVIC_IRQChannelSubPriority = 3; //从优先级 3 级
NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE; //IRQ 通道被使能
NVIC_Init(&NVIC_InitStructure); //④初始化 NVIC 寄存器
TIM_Cmd(TIM3, ENABLE); //⑤使能 TIM3
}
 

void TIM6_IRQHandler(void)  //TM2的中断函数
{
	if (TIM_GetITStatus(TIM6, TIM_IT_Update) == SET)
	{
		LED_RED=!LED_RED;
		Buzzer_IN=1;
		TIM_ClearITPendingBit(TIM6, TIM_IT_Update);
	}
}

/*****************************************************END OF FILE*********************************************************/
